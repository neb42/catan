---
phase: 02-core-game-loop
plan: 05
type: execute
wave: 3
depends_on: [02-03, 02-04]
files_modified:
  - apps/web/src/game/UI/ResourceCards.tsx
  - apps/web/src/game/UI/TurnIndicator.tsx
  - apps/web/src/game/UI/PlayerList.tsx
  - apps/web/src/game/GameView.tsx
  - apps/web/src/app/app.tsx
autonomous: true

must_haves:
  truths:
    - "User sees their own resource cards with counts (wood, wheat, sheep, brick, ore)"
    - "User sees clear indicator of whose turn it is"
    - "User sees current turn phase (roll, main, end)"
    - "User sees all players with colors and resource totals"
    - "Resources animate when distributed (cards fly to players)"
  artifacts:
    - path: "apps/web/src/game/UI/ResourceCards.tsx"
      provides: "Player resource card display"
      exports: ["ResourceCards"]
      min_lines: 40
    - path: "apps/web/src/game/UI/TurnIndicator.tsx"
      provides: "Turn and phase indicator"
      exports: ["TurnIndicator"]
      min_lines: 30
    - path: "apps/web/src/game/GameView.tsx"
      provides: "Main game layout container"
      exports: ["GameView"]
      min_lines: 50
  key_links:
    - from: "apps/web/src/game/UI/ResourceCards.tsx"
      to: "apps/web/src/stores/gameStore.ts"
      via: "reads player resources from game state"
      pattern: "useGameStore.*gameState.*players.*resources"
    - from: "apps/web/src/game/GameView.tsx"
      to: "apps/web/src/game/Board/HexGrid.tsx"
      via: "renders board and UI together"
      pattern: "import.*HexGrid"
---

<objective>
Create resource tracking UI with animated resource cards, turn indicators, and player list. Display current player's resource cards with counts, show whose turn it is and which phase, and list all players with their resource totals. Animate resource distribution when dice rolled.

Purpose: Provide complete game UI with all information needed to play. After this plan, users can see and track resources, know whose turn it is, and monitor game state.

Output: Working game interface with board, resource cards, turn indicators, player list, and dice roller integrated into cohesive layout.
</objective>

<execution_context>
@./.github/get-shit-done/workflows/execute-plan.md
@./.github/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-core-game-loop/02-CONTEXT.md
@.planning/phases/02-core-game-loop/02-RESEARCH.md
@libs/shared/src/schemas/game.ts
@apps/web/src/game/Board/HexGrid.tsx
@apps/web/src/game/UI/DiceRoller.tsx
@apps/web/src/stores/gameStore.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ResourceCards component with animation</name>
  <files>apps/web/src/game/UI/ResourceCards.tsx</files>
  <action>
Create `apps/web/src/game/UI/ResourceCards.tsx` to display player's resource cards following RESEARCH.md Pattern 6:

**Component**: Show 5 resource types (wood, wheat, sheep, brick, ore) with counts

```typescript
import { motion } from 'motion/react';
import { useGameStore } from '../../stores/gameStore';

export function ResourceCards({ playerId }: { playerId: string }) {
  const player = useGameStore((s) => 
    s.gameState?.players.find((p) => p.id === playerId)
  );
  
  if (!player) return null;
  
  const resources = [
    { type: 'wood', label: 'Wood', color: '#228B22' },
    { type: 'brick', label: 'Brick', color: '#CD5C5C' },
    { type: 'sheep', label: 'Sheep', color: '#90EE90' },
    { type: 'wheat', label: 'Wheat', color: '#FFD700' },
    { type: 'ore', label: 'Ore', color: '#808080' },
  ];
  
  return (
    <div style={{ display: 'flex', gap: '0.5rem' }}>
      {resources.map(({ type, label, color }) => (
        <motion.div
          key={type}
          initial={{ y: -20, opacity: 0 }}
          animate={{ y: 0, opacity: 1 }}
          transition={{ duration: 0.3 }}
          style={{
            width: 80,
            height: 100,
            backgroundColor: color,
            borderRadius: 8,
            border: '2px solid black',
            display: 'flex',
            flexDirection: 'column',
            alignItems: 'center',
            justifyContent: 'center',
            color: 'white',
            fontWeight: 'bold',
          }}
        >
          <div>{label}</div>
          <div style={{ fontSize: 24 }}>{player.resources[type as keyof typeof player.resources]}</div>
        </motion.div>
      ))}
    </div>
  );
}
```

**Animation**: Use motion.div with y:-20‚Üí0 fade-in when component mounts or count changes (resource distribution). Follow CONTEXT.md: "Animate resource cards flying from board to player's hand" - implement key change animation that triggers on resource count increase.

**Styling**: Card-based design with resource type colors, count in large font. Simple and readable.

Component is reusable for any player ID. Default to showing current player's own resources.
  </action>
  <verify>
Test resource cards:
1. Render with player who has resources
2. Verify all 5 resource types display
3. Verify counts match gameState.players[].resources
4. Test animation: manually increment resource, see card animate
  </verify>
  <done>
ResourceCards.tsx component exists. Displays 5 resource types with correct counts. Animation plays on mount and count changes. Styling matches design intent.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create TurnIndicator component</name>
  <files>apps/web/src/game/UI/TurnIndicator.tsx</files>
  <action>
Create `apps/web/src/game/UI/TurnIndicator.tsx` to show current turn and phase following REQUIREMENTS.md TURN-05, UX-01:

**Component**: Display whose turn it is and current phase

```typescript
import { useGameStore } from '../../stores/gameStore';

export function TurnIndicator() {
  const gameState = useGameStore((s) => s.gameState);
  const myPlayerId = useGameStore((s) => s.myPlayerId);
  
  if (!gameState) return null;
  
  const currentPlayer = gameState.players.find((p) => p.id === gameState.currentPlayer);
  const isMyTurn = gameState.currentPlayer === myPlayerId;
  
  const phaseDisplay = {
    initial_placement: `Initial Placement - Round ${gameState.placementRound}/8`,
    gameplay: gameState.turnPhase === 'roll' ? 'Roll Dice' : 
              gameState.turnPhase === 'main' ? 'Main Phase (Trade/Build)' :
              'End Turn',
  };
  
  return (
    <div style={{
      padding: '1rem',
      backgroundColor: isMyTurn ? '#4CAF50' : '#f0f0f0',
      color: isMyTurn ? 'white' : 'black',
      fontWeight: 'bold',
      fontSize: 18,
      textAlign: 'center',
      borderRadius: 8,
    }}>
      {isMyTurn ? 'üé≤ Your Turn' : `Waiting for ${currentPlayer?.nickname}`}
      <div style={{ fontSize: 14, marginTop: '0.25rem' }}>
        {phaseDisplay[gameState.phase as keyof typeof phaseDisplay]}
      </div>
    </div>
  );
}
```

Follow CONTEXT.md: "Turn status display: Show simple 'Your Turn' or 'Waiting for [Player Name]' messages". Highlight current player's turn prominently (green background). Show phase clearly.

For initial placement, show round number (1-8). For gameplay, show turn phase (roll/main/end).
  </action>
  <verify>
Test turn indicator:
1. Verify displays correct player name
2. Check "Your Turn" shows for current player
3. Verify phase displays correctly (initial placement vs gameplay phases)
4. Test styling highlights current player's turn
  </verify>
  <done>
TurnIndicator.tsx component exists. Displays current player and turn phase. Highlights current player with green background. Phase information clear and accurate.
  </done>
</task>

<task type="auto">
  <name>Task 3: Create PlayerList component</name>
  <files>apps/web/src/game/UI/PlayerList.tsx</files>
  <action>
Create `apps/web/src/game/UI/PlayerList.tsx` to show all players with colors and resource counts following REQUIREMENTS.md UX-04:

**Component**: List all players with colors, resource totals, and current turn marker

```typescript
import { useGameStore } from '../../stores/gameStore';

export function PlayerList() {
  const gameState = useGameStore((s) => s.gameState);
  
  if (!gameState) return null;
  
  return (
    <div style={{ padding: '1rem', backgroundColor: '#f9f9f9', borderRadius: 8 }}>
      <h3>Players</h3>
      {gameState.players.map((player) => {
        const isCurrentPlayer = player.id === gameState.currentPlayer;
        const totalResources = Object.values(player.resources).reduce((a, b) => a + b, 0);
        
        return (
          <div
            key={player.id}
            style={{
              display: 'flex',
              alignItems: 'center',
              gap: '0.5rem',
              padding: '0.5rem',
              backgroundColor: isCurrentPlayer ? '#e8f5e9' : 'white',
              borderRadius: 4,
              marginBottom: '0.5rem',
              border: isCurrentPlayer ? '2px solid #4CAF50' : '1px solid #ddd',
            }}
          >
            <div
              style={{
                width: 30,
                height: 30,
                borderRadius: '50%',
                backgroundColor: player.color,
                border: '2px solid black',
              }}
            />
            <div style={{ flex: 1 }}>
              <div style={{ fontWeight: 'bold' }}>{player.nickname}</div>
              <div style={{ fontSize: 12, color: '#666' }}>
                {totalResources} resources ‚Ä¢ {player.victoryPoints} VP
              </div>
            </div>
            {isCurrentPlayer && <span>‚≠ê</span>}
          </div>
        );
      })}
    </div>
  );
}
```

**Display**:
- Player color (circular avatar)
- Nickname
- Total resource count (not breakdown - opponents can't see exact resources)
- Victory points
- Star indicator for current player

Reuse player color display pattern from Phase 1.1 Lobby if applicable. Show all players in turn order.
  </action>
  <verify>
Test player list:
1. Verify all players display with correct colors
2. Check resource totals calculate correctly
3. Verify current player highlighted with star
4. Test victory points display
  </verify>
  <done>
PlayerList.tsx component exists. Displays all players with colors, resource totals, and VP. Current player highlighted with border and star indicator.
  </done>
</task>

<task type="auto">
  <name>Task 4: Create GameView layout container</name>
  <files>apps/web/src/game/GameView.tsx</files>
  <action>
Create `apps/web/src/game/GameView.tsx` as main game layout that combines all UI components:

**Layout structure**:
```
+-------------------------------------------+
|  TurnIndicator                            |
+-------------------------------------------+
|             |                             |
|  PlayerList |      HexGrid (Board)        |
|             |                             |
|  DiceRoller |                             |
|             |                             |
+-------------------------------------------+
|  ResourceCards (current player)           |
+-------------------------------------------+
```

```typescript
import { HexGrid } from './Board/HexGrid';
import { DiceRoller } from './UI/DiceRoller';
import { ResourceCards } from './UI/ResourceCards';
import { TurnIndicator } from './UI/TurnIndicator';
import { PlayerList } from './UI/PlayerList';
import { useGameStore } from '../stores/gameStore';

export function GameView() {
  const myPlayerId = useGameStore((s) => s.myPlayerId);
  
  return (
    <div style={{
      display: 'grid',
      gridTemplateRows: 'auto 1fr auto',
      gridTemplateColumns: '250px 1fr',
      height: '100vh',
      gap: '1rem',
      padding: '1rem',
    }}>
      {/* Top bar - full width */}
      <div style={{ gridColumn: '1 / -1' }}>
        <TurnIndicator />
      </div>
      
      {/* Left sidebar */}
      <div style={{ display: 'flex', flexDirection: 'column', gap: '1rem' }}>
        <PlayerList />
        <DiceRoller />
      </div>
      
      {/* Main board area */}
      <div style={{
        display: 'flex',
        alignItems: 'center',
        justifyContent: 'center',
        backgroundColor: '#e3f2fd',
        borderRadius: 8,
      }}>
        <HexGrid />
      </div>
      
      {/* Bottom bar - full width */}
      <div style={{ gridColumn: '1 / -1' }}>
        <ResourceCards playerId={myPlayerId} />
      </div>
    </div>
  );
}
```

Use CSS Grid for layout. Board gets central focus, UI elements around edges. Responsive (desktop-first, mobile is v2).

Background color for board area should complement hex tiles (light blue ocean theme).
  </action>
  <verify>
Test game view layout:
1. All components render in correct positions
2. Board centered and prominent
3. UI elements accessible and readable
4. Layout responds to window resize
  </verify>
  <done>
GameView.tsx component exists. All UI components integrated into cohesive layout. Board centered, turn indicator at top, resources at bottom, player list and dice in sidebar.
  </done>
</task>

<task type="auto">
  <name>Task 5: Update App.tsx to use GameView</name>
  <files>apps/web/src/app/app.tsx</files>
  <action>
Update `apps/web/src/app/app.tsx` to render GameView instead of just HexGrid:

Replace previous integration (from Plan 03) with:

```typescript
import { GameView } from '../game/GameView';
import { useGameStore } from '../stores/gameStore';
// ... existing lobby imports

export function App() {
  const gameState = useGameStore((s) => s.gameState);
  
  if (gameState) {
    return <GameView />;
  }
  
  // Existing lobby UI
  return (
    <div>
      {/* LandingForm, Lobby, etc. */}
    </div>
  );
}
```

GameView now encapsulates all game UI (board, resources, turn indicator, player list, dice). Clean separation between lobby and game.

Ensure WebSocket connection persists through lobby‚Üígame transition. Add myPlayerId to gameStore (set from WebSocket room_created or player_joined message with player ID).
  </action>
  <verify>
Test full flow:
1. Create room, players join
2. Start game ‚Üí GameView appears
3. Verify all UI components visible and functional
4. Test dice rolling, resource updates, turn progression
5. Check layout on different screen sizes
  </verify>
  <done>
App.tsx updated to render GameView when game state exists. Lobby‚ÜíGame transition smooth. All UI components integrated and functional. Complete game interface working.
  </done>
</task>

</tasks>

<verification>
After completing all tasks:

1. **Resource cards display**: Show all 5 resource types with correct counts for current player
2. **Resource animation**: Cards animate when resources gained (dice roll distribution)
3. **Turn indicator works**: Shows current player and phase accurately
4. **Player list accurate**: All players displayed with colors, resource totals, VP
5. **Layout functional**: All components render in correct positions, board prominent
6. **Full game flow**: Create‚ÜíStart‚ÜíPlace‚ÜíRoll‚ÜíResources update‚ÜíNext turn
</verification>

<success_criteria>
- ResourceCards component displays wood, wheat, sheep, brick, ore with current counts
- Resource cards animate when distributed (~300-500ms)
- TurnIndicator shows current player name and turn phase clearly
- Current player's turn highlighted prominently (green background, "Your Turn")
- PlayerList shows all players with colors, resource totals, and victory points
- Current player in PlayerList marked with indicator (star/checkmark)
- GameView layout integrates board, resources, turn info, player list, and dice roller
- App transitions from lobby to GameView when game starts
- Complete game interface functional with all Phase 2 features visible
</success_criteria>

<output>
After completion, create `.planning/phases/02-core-game-loop/02-05-SUMMARY.md` documenting:
- UI component architecture and layout strategy
- Resource card animation approach
- Turn indicator design and highlighting approach
- GameView layout structure and grid system
- Integration patterns between components and game store
- Any UX decisions made during implementation
</output>
