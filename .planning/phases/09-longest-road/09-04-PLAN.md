---
phase: 09-longest-road
plan: 04
type: execute
wave: 4
depends_on: ['09-03']
files_modified: []
autonomous: false

must_haves:
  truths:
    - 'Longest road awards at exactly 5 roads'
    - 'Transfer occurs when surpassed'
    - 'Ties favor current holder'
    - 'Opponent settlements break roads'
  artifacts: []
  key_links: []
---

<objective>
Human verification of the complete longest road feature.

Purpose: Verify the full longest road system works end-to-end in a real game scenario. Test edge cases around award threshold, transfer rules, and opponent settlement blocking.

Output: Confirmed working feature or list of issues to address.
</objective>

<execution_context>
@/Users/bmcalindin/.config/opencode/get-shit-done/workflows/execute-plan.md
@/Users/bmcalindin/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/09-longest-road/09-CONTEXT.md
@.planning/phases/09-longest-road/09-03-SUMMARY.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete longest road tracking system:
- DFS algorithm calculates longest continuous road per player
- Award given at 5+ road segments
- Transfer when another player exceeds current holder
- Ties favor current holder
- Opponent settlements block road continuity
- Road lengths visible in player list
- Longest Road badge on holder
- Toast notification on transfer
  </what-built>
  <how-to-verify>
**Setup:**
1. Start the dev server: `npm run dev`
2. Open 2 browser windows to http://localhost:5173
3. Create a room and join with 2 players
4. Start game and complete initial placement

**Test 1: Award threshold (5 roads)**

1. As Player 1, build roads until you have exactly 4
2. Verify: No Longest Road badge appears
3. Verify: Player list shows "Roads: 4" for Player 1
4. Build one more road (now 5 total)
5. Verify: Longest Road badge appears on Player 1
6. Verify: Toast notification announces award

**Test 2: Road length display**

1. Check both players show their road count in player list
2. Build more roads as either player
3. Verify: Counts update in real-time

**Test 3: Transfer when surpassed**

1. As Player 2, build roads until you have 6 (Player 1 has 5)
2. Verify: Longest Road badge moves to Player 2
3. Verify: Toast shows "Player 2 takes Longest Road from Player 1!"

**Test 4: Tie handling**

1. As Player 1, build roads until tied with Player 2
2. Verify: Player 2 (current holder) keeps the badge
3. Verify: No toast/notification (ties are silent per CONTEXT.md)

**Test 5: Opponent settlement breaks road (optional - if you can set up scenario)**

1. If Player 1 has a long chain, have Player 2 place settlement breaking it
2. Verify: Player 1's road length recalculates to show segments
3. Verify: If P1 drops below 5, badge may disappear

**Pass criteria:**

- Road lengths show for all players
- Badge appears only at 5+ roads
- Badge transfers when surpassed (not on tie)
- Toast shows on transfer
  </how-to-verify>
  <resume-signal>
  Type "approved" if all tests pass, or describe any issues found.
  </resume-signal>
  </task>

</tasks>

<verification>
Human verification completed via checkpoint above.
</verification>

<success_criteria>

- All verification tests pass
- Award threshold (5 roads) works correctly
- Transfer on surpass works correctly
- Ties favor current holder
- Road lengths visible for all players
  </success_criteria>

<output>
After completion, create `.planning/phases/09-longest-road/09-04-SUMMARY.md`
</output>
