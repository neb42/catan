---
phase: 11-victory
plan: 05
type: execute
wave: 4
depends_on: ['11-04']
files_modified: []
autonomous: false

must_haves:
  truths:
    - 'VP calculation is correct for all sources'
    - 'Victory triggers at exactly 10 VP'
    - 'Victory announcement UX matches CONTEXT.md specification'
  artifacts: []
  key_links: []
---

<objective>
Verify complete victory system through manual testing.

Purpose: Ensure VP calculation, win detection, and victory UX work correctly end-to-end.
Output: Verified working victory system ready for phase completion.
</objective>

<execution_context>
@/Users/bmcalindin/.config/opencode/get-shit-done/workflows/execute-plan.md
@/Users/bmcalindin/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/STATE.md
@.planning/phases/11-victory/11-04-SUMMARY.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete victory point system including VP calculation, win detection, and victory announcement UI</what-built>
  <how-to-verify>
**Setup:**
1. Start the dev server: `npm run dev`
2. Open 3-4 browser windows to localhost:3000
3. Create a room and have all players join
4. Start the game

**Test 1: VP Display**

1. During initial placement, verify each player shows "0 VP" badge
2. After placing settlements, verify VP updates to 2 (1 per settlement)
3. Verify VP breakdown shows icons: üè†2 for settlements

**Test 2: VP Calculation Accuracy**

1. Build a city - verify VP increases by 1 (net: -1 settlement + 2 city)
2. Build 5+ roads to claim Longest Road - verify +2 VP and üõ§Ô∏è2 icon appears
3. Play 3 knights to claim Largest Army - verify +2 VP and ‚öîÔ∏è2 icon appears

**Test 3: Win Detection**

1. Accumulate resources (use debug panel or normal gameplay)
2. Build/upgrade until a player reaches exactly 10 VP
3. Verify:
   - Game ends immediately on the action that reaches 10 VP
   - If player has VP dev cards, reveal overlay shows first ("Revealed: X VP cards!")
   - After 1-2 seconds, victory modal appears
   - Confetti/fireworks animation plays
   - Winner name highlighted with total VP
   - All players' final VP breakdown visible

**Test 4: Victory Modal Actions**

1. Click "View Board" - modal closes, board still visible with final game state
2. Click "Return to Lobby" - navigates to home page

**Test 5: Mid-Turn Win (if possible)**

1. Set up scenario where opponent building a road would transfer Longest Road to you
2. Have opponent build the road
3. Verify you win immediately during their turn if this gives you 10 VP

**Expected Results:**

- VP display accurate at all times
- Game ends exactly at 10 VP (not before, not after)
- Victory UI flows smoothly: reveal (if VP cards) ‚Üí modal with confetti
- Both modal buttons work correctly
  </how-to-verify>
  <resume-signal>Type "verified" if all tests pass, or describe issues found</resume-signal>
  </task>

</tasks>

<verification>
- [ ] VP display shows correct totals during gameplay
- [ ] VP breakdown icons match: settlements, cities, longest road, largest army
- [ ] Win triggers at exactly 10 VP
- [ ] Reveal overlay shows (only if VP cards exist)
- [ ] Victory modal has confetti, winner info, all player VP
- [ ] "View Board" closes modal
- [ ] "Return to Lobby" navigates away
</verification>

<success_criteria>

- All 5 test scenarios pass
- Victory UX matches CONTEXT.md specification
- No edge cases broken
  </success_criteria>

<output>
After completion, create `.planning/phases/11-victory/11-05-SUMMARY.md`
</output>
