---
phase: 02-board-generation-and-rendering
plan: 04
type: execute
wave: 3
depends_on: ["02-03"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "User can see generated board after game starts"
    - "Hexes display terrain textures correctly"
    - "Number tokens are readable"
    - "Ports are positioned correctly"
    - "Board layout matches Catan standard"
  artifacts:
    - path: "apps/web/src/components/Board/Board.tsx"
      provides: "Verified working board rendering"
      min_lines: 80
    - path: "apps/api/src/game/board-generator.ts"
      provides: "Verified board generation"
      min_lines: 100
  key_links:
    - from: "Server WebSocket handler"
      to: "generateBoard()"
      via: "calls on game start"
      pattern: "generateBoard\\(\\)"
    - from: "Client Game component"
      to: "Board component"
      via: "renders with board prop"
      pattern: "<Board.*board="
---

<objective>
Verify end-to-end board generation and rendering with human validation of visual quality and rule compliance.

Purpose: Confirm that Phase 2 requirements (BOARD-01, BOARD-02, BOARD-03) are fully met through interactive testing and visual verification. Validate that the board appears correct to human players and follows Catan rules.

Output: Verified, working board generation and rendering system ready for Phase 3 (Initial Placement).
</objective>

<execution_context>
@./.github/get-shit-done/workflows/execute-plan.md
@./.github/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-board-generation-and-rendering/02-CONTEXT.md
@.planning/REQUIREMENTS.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete board generation and rendering system:
- Server-side board generation with fairness validation
- Board state schemas and WebSocket transmission
- react-hexgrid based rendering with terrain textures
- Number tokens with 6/8 highlighting
- Port placement at coast edges
- Game start transition from lobby
  </what-built>
  
  <how-to-verify>
**1. Start the application:**
```bash
# Terminal 1 - Start API server
npx nx serve api

# Terminal 2 - Start web app
npx nx serve web
```

**2. Create and start a game:**
- Open http://localhost:5173 in two browser tabs
- Tab 1: Enter nickname → Create Room → copy room code
- Tab 2: Enter nickname → Join Room → paste room code
- Both tabs: Select different colors
- Both tabs: Click "Ready"
- Wait for countdown to complete

**3. Verify board generation (BOARD-01):**
After game starts, check that:
- [ ] Board has exactly 19 hexes visible
- [ ] Terrain types are recognizable (forest, hills, fields, pasture, mountains, desert)
- [ ] Terrain distribution looks reasonable (not all forests clustered together)
- [ ] Count terrains (should be: 4 forest, 4 fields, 4 pasture, 3 hills, 3 mountains, 1 desert)
- [ ] Desert hex has no number token
- [ ] Hex layout forms proper Catan board shape (hexagonal overall shape)

**4. Verify number token placement (BOARD-02):**
- [ ] All non-desert hexes have number tokens
- [ ] Numbers are readable (not too small, good contrast)
- [ ] Numbers 6 and 8 appear in red/highlighted (different from other numbers)
- [ ] **Critical: NO two hexes with 6 or 8 are adjacent** (check each 6 and 8 carefully)
- [ ] Number distribution looks reasonable (2, 3, 3, 4, 4, 5, 5, 6, 6, 8, 8, 9, 9, 10, 10, 11, 11, 12)

**5. Verify port placement (BOARD-03):**
- [ ] Exactly 9 ports visible around coast
- [ ] Ports appear at edges (not overlapping hexes)
- [ ] Port icons are visible and recognizable
- [ ] Port types distinguishable (generic vs resource-specific)
- [ ] Ports distributed around perimeter (not all clustered)

**6. Verify visual quality:**
- [ ] Board is centered in viewport
- [ ] Board size is appropriate (not too large, not too small)
- [ ] Terrain textures display correctly (SVG assets loaded)
- [ ] No missing textures or broken images
- [ ] Warm beige background (#F9F4EF) visible
- [ ] Shadows/depth effects make hexes look 3D

**7. Verify multi-player consistency:**
- [ ] Both browser tabs show IDENTICAL boards (same hex positions, same numbers, same ports)
- [ ] No desync between players

**8. Test multiple board generations:**
- Refresh both tabs, create new room, start new game
- Repeat 2-3 times
- [ ] Each game generates a DIFFERENT board (randomization working)
- [ ] All boards follow rules (no adjacent 6/8, correct terrain counts)

**9. Check for errors:**
- Open browser DevTools Console (F12)
- [ ] No red error messages
- [ ] No warnings about missing assets
- Check Network tab:
- [ ] game_started WebSocket message contains board data
- [ ] All SVG assets load successfully (tiles/, ports/)

**10. Performance check:**
- [ ] Board appears within 1 second of game start
- [ ] No lag or stuttering when board renders
- [ ] UI remains responsive after board loads
  </how-to-verify>
  
  <resume-signal>
Type **"approved"** if all checks pass and board looks correct.

If issues found, describe the specific problems:
- Which hexes have adjacent 6/8
- Which assets are missing
- What visual artifacts appear
- Any desync between players

Then type **"continue"** after fixes are made to re-verify.
  </resume-signal>
</task>

</tasks>

<verification>
This checkpoint IS the verification for Phase 2.

After approval:
- Phase 2 requirements BOARD-01, BOARD-02, BOARD-03 are complete
- Board generation proven to work correctly
- Visual quality meets design standards
- System ready for Phase 3 (Initial Placement)
</verification>

<success_criteria>
- All verification checklist items pass
- No adjacent 6/8 found in multiple test games
- Both players see identical boards
- Visual quality matches design aesthetic from Phase 1.1
- No console errors or asset loading issues
- Human tester approves board appearance
</success_criteria>

<output>
After completion, create `.planning/phases/02-board-generation-and-rendering/02-04-SUMMARY.md`
</output>
