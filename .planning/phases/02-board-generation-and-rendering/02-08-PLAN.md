---
phase: 02-board-generation-and-rendering
plan: 08
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/web/public/assets/tiles/desert.svg
  - apps/web/public/assets/tiles/fields.svg
  - apps/web/public/assets/tiles/forest.svg
  - apps/web/public/assets/tiles/hills.svg
  - apps/web/public/assets/tiles/mountains.svg
  - apps/web/public/assets/tiles/pasture.svg
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "Terrain fills centered within hex borders"
    - "No 'double hexagon' visual artifacts"
    - "SVG patterns contain only texture content, not geometric shapes"
  artifacts:
    - path: "apps/web/public/assets/tiles/forest.svg"
      provides: "Forest texture without hexagon boundary"
      min_lines: 8
    - path: "apps/web/public/assets/tiles/fields.svg"
      provides: "Fields texture without hexagon boundary"
      min_lines: 8
    - path: "apps/web/public/assets/tiles/pasture.svg"
      provides: "Pasture texture without hexagon boundary"
      min_lines: 8
    - path: "apps/web/public/assets/tiles/hills.svg"
      provides: "Hills texture without hexagon boundary"
      min_lines: 8
    - path: "apps/web/public/assets/tiles/mountains.svg"
      provides: "Mountains texture without hexagon boundary"
      min_lines: 8
    - path: "apps/web/public/assets/tiles/desert.svg"
      provides: "Desert texture without hexagon boundary"
      min_lines: 8
  key_links:
    - from: "SVG tile files"
      to: "react-hexgrid Pattern component"
      via: "image href attribute"
      pattern: "Pattern.*href"
---

<objective>
Fix hex terrain fill alignment by removing hexagon boundary paths from SVG tile assets.

Purpose: Resolve MEDIUM priority UAT Issue #3 where terrain fills appear shifted off-center within hexagons. SVG assets currently include hexagon boundary paths, creating a "double hexagon" effect when react-hexgrid's Pattern component applies them as fills. Pattern expects pure texture content, not geometric container shapes.

Output: Clean SVG tile files containing only texture elements, properly centered within hex boundaries by react-hexgrid.
</objective>

<execution_context>
@./.github/get-shit-done/workflows/execute-plan.md
@./.github/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-board-generation-and-rendering/02-03-SUMMARY.md
@.planning/phases/02-board-generation-and-rendering/02-board-generation-and-rendering-UAT.md
@apps/web/public/assets/tiles/
@apps/web/src/components/Board/TerrainHex.tsx
</context>

<tasks>

<task type="auto">
  <name>Remove hexagon boundary paths from all SVG tile files</name>
  <files>
    apps/web/public/assets/tiles/desert.svg
    apps/web/public/assets/tiles/fields.svg
    apps/web/public/assets/tiles/forest.svg
    apps/web/public/assets/tiles/hills.svg
    apps/web/public/assets/tiles/mountains.svg
    apps/web/public/assets/tiles/pasture.svg
  </files>
  <action>
Root cause: SVG tile files contain hexagon boundary path elements like:
```xml
<path d="M100 10 L178 55 L178 145 L100 190 L22 145 L22 55 Z" fill="#228B22" stroke="black" stroke-width="2"/>
```

When react-hexgrid's Pattern component uses these SVGs as texture fills, the embedded hexagon creates a "double hexagon" effect, causing visual misalignment. The Pattern component expects only texture content (trees, wheat, rocks, etc.) and handles the hexagon boundary itself.

Fix for each SVG file:
1. Remove the hexagon path element (typically the first path with 6 coordinate points in M...L...L...L...L...L...Z format)
2. Keep only the texture/icon elements (trees, wheat stalks, brick patterns, mountains, sheep, sand)
3. Maintain the viewBox and dimensions (200x200 viewBox="0 0 200 200")
4. Preserve texture element positioning relative to center (100, 100)

Files to modify:
- **forest.svg**: Remove hexagon path, keep tree trunk + foliage paths
- **fields.svg**: Remove hexagon path, keep wheat stalks
- **pasture.svg**: Remove hexagon path, keep sheep/grass elements
- **hills.svg**: Remove hexagon path, keep brick/hill pattern
- **mountains.svg**: Remove hexagon path, keep mountain peaks
- **desert.svg**: Remove hexagon path, keep sand/dune elements

Example transformation for forest.svg:

Before:
```xml
<svg width="200" height="200" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
  <path d="M100 10 L178 55 L178 145 L100 190 L22 145 L22 55 Z" fill="#228B22" stroke="black" stroke-width="2"/>
  <rect x="90" y="130" width="20" height="30" fill="#8B4513"/>
  <path d="M50 130 L100 40 L150 130 Z" fill="#006400"/>
</svg>
```

After:
```xml
<svg width="200" height="200" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
  <rect x="90" y="130" width="20" height="30" fill="#8B4513"/>
  <path d="M50 130 L100 40 L150 130 Z" fill="#006400"/>
  <path d="M60 100 L100 30 L140 100 Z" fill="#008000"/>
</svg>
```

Apply this pattern to all 6 SVG files. Do NOT modify texture colors or positions - only remove hexagon boundaries.
  </action>
  <verify>
1. Verify SVG files are valid XML: `for f in apps/web/public/assets/tiles/*.svg; do xmllint --noout "$f" 2>&1 || echo "Error in $f"; done` (if xmllint available, otherwise just open in browser)
2. Start dev servers: `npx nx serve web` and `npx nx serve api`
3. Create a new game board
4. Visually inspect all 6 terrain types:
   - Terrain textures should be centered within hex borders
   - No double hexagon outlines visible
   - Textures should fill the hex properly without shifting
5. Test with multiple board generations to see all terrain types
  </verify>
  <done>
- All 6 SVG files contain only texture elements (no hexagon paths)
- SVG files remain valid XML
- Terrain fills centered within hex boundaries during rendering
- No double hexagon visual artifacts
- Professional visual appearance restored
  </done>
</task>

</tasks>

<verification>
**File Inspection:**
- Open each SVG file and confirm no hexagon boundary paths
- Verify texture elements remain intact
- Check viewBox preserved (0 0 200 200)

**Visual Inspection:**
- Create 3-5 new game boards
- Verify all 6 terrain types render correctly:
  - Forest (green trees)
  - Fields (yellow wheat)
  - Pasture (green grass/sheep)
  - Hills (red/brown bricks)
  - Mountains (gray peaks)
  - Desert (tan/beige sand)
- Confirm textures centered within hex borders
- Look for any remaining visual misalignment

**UAT Re-test:**
- Run UAT Test #6: "Board Rendering - Terrain Hexes Display"
- Should now pass: Hexes render with distinct terrain styling, properly aligned
</verification>

<success_criteria>
**Observable truths achieved:**
1. User sees terrain textures properly centered within hex boundaries
2. No "double hexagon" visual artifacts present
3. All 6 terrain types render with professional visual quality
4. Hex fills aligned consistently across entire board

**Measurable outcomes:**
- UAT Test #6 status changes from "failed" to "passed"
- All 6 SVG files contain no hexagon boundary paths
- Visual confirmation: centered textures, no misalignment
- Professional appearance restored for board rendering
</success_criteria>

<output>
After completion, create `.planning/phases/02-board-generation-and-rendering/02-08-SUMMARY.md`
</output>
